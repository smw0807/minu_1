# 9-2 상태(State)

상태(State) 패턴은 컨텍스트의 상태에 따라 전략이 변경되는 특별한 전략 패턴이다.

9-1에서 살펴본 전략 패턴은 환경 설정의 속성 또는 입력 인자와 같은 다양한 변수에 따라 전략을 선택하는 방법으로,  
이 선택이 완료되면 한번 생성된 컨텍스트에서는 전략이 변경되지 않은 상태로 유지된다.  
상태 패턴에서는 전략(상태 패턴에서는 **상태**라고도 함)은 동적이며 컨텍스트의 생존 주기 동안 변경될 수 있으므로 내부 상태에 따라 동작을 조정할 수 있다.

상태 패턴을 사용하면 서로 다른 컨텍스트 상태에서 서로 다른 전략을 선택한다.  
이는 컨텍스트 객체가 상태에 따라 다른 동작을 채택한다는 것을 뜻한다.

예를 들면,  
호텔 예약 시스템과 객실 예약을 모델링하는 Reservation이라는 객체가 있다고 가정했을 때  
이것은 상태에 따라 객체의 동작을 조정해야 하는 일반적인 상황이다.  
다음과 같은 일련의 이벤트를 생각해 보자.

- 예약이 처음 생성되면 사용자가 예약을 확인할 수 있다. (confirm() 함수)  
  아직 예약이 완료되지 않았기 때문에 취소할 수 없다.(cancel()함수)  
  그러나 구매하기 전에 마음이 바뀌면 삭제할 수 있다.(delete()함수)
- 예약이 완료되면 confirm() 함수를 다시 사용하는 것은 의미가 없다.  
  그러나 이제는 예약을 취소할 수 있지만 기록을 보관해야 하므로 더는 객체를 삭제할 수 없다.(데이터 상태값만 변경?)
- 예약일 전날에는 더 이상 예약을 취소할 수 없다.

이 패턴을 사용하면 Reservation 객체가 한 동작에서 다른 동작으로 쉽게 전환할 수 있다.  
이것은 단순히 각각의 상태 변경에 따라 다른 전략(상태 객체)의 활성화가 필요하다.

<aside>
💡 상태 전환은 컨텍스트 객체, 클라이언트 코드 또는 상태 객체 자체에 의해 시작되고 제어될 수 있다.
이때 마지막 옵션은 컨텍스트가 가능한 모든 상태와 이들 사이의 전환 방법에 대해 알 필요가 없기 때문에 일반적으로 유연성과 디커플링 측면에서 최상의 결과를 제공한다.
</aside>
