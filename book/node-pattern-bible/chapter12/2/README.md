# 복제 및 로드 밸런싱

# 12-2 복제 및 로드 밸런싱

기존의 멀티스레드 웹 서버는 일반적으로 시스템에 할당된 리소스를 더 이상 업그레이드 할 수 없거나 단순히 다른 시스템을 시작하는 것보다 비용이 더 많이 드는 경우에만 수평적으로 확장 된다.

다중 스레드를 사용하는 전통적은 웹 서버는 사용 가능한 모든 프로세스와 메모리를 사용하여 서버의 모든 처리 능력을 활용할 수 있다.  
반대로 단일 스레드인 Node.js 애플리케이션은 일반적으로 기존 웹 서버에 비해 훨씬 더 빨리 확장되어야 한다.  
단일 머신의 맥락에서도 사용 가능한 모든 리소스를 활용하려면 애플리케이션을 “확장” 하는 방법을 찾아야 한다.

<aside>
💡 Node.js에서 `**수직 확장**`(단일 머신에 더 많은 리소스 추가)과 `**수평 확장**`(인프라에 더 많은 머신 추가)은 거의 동일한 개념이다.   
두 가지 모두, 사용 가능한 모든 처리 능력을 활용하기 위해 유사한 기술을 사용한다.

</aside>

확장이 강제되면 애플리케이션의 다른 속성, 특히 가용성 및 내결함성에 유익한 효과를 가져다 준다.  
실제로 복제에 의한 Node.js 애플리케이션의 확장 작업은 비교적 간단하며, 단지 이중화, 내결함성 설정을 목적으로 더 많은 리소스가 필요가 없는 경우에도 종종 구현된다.

이는 개발자가 애플리케이션의 초기 단계부터 확장성을 고려하도록 하여 애플리케이션이 여러 프로세스 또는 시스템에서 공유할 수 없는 리소스에 의존하지 않도록 한다.  
실제로 애플리케이션을 확장하기 위한 절대적인 전제 조건은 각 인스턴스가 메모리나 디스크와 같이 공유할 수 없는 리소스에 공통정보를 저장할 필요가 없다는 것이다.  
예를 들어, 웹 서버에서 세션 데이터를 메모리나 디스크에 저장하는 것은 확장에 적합하지 않는 관행이다.  
대신 공유 데이터베이스를 사용하면 배포된 위치에 관계없이 각 인스턴스가 동일한 세션 정보에 접근할 수 있다.

## 12-2-1 클로스터 모듈

Node.js에서 단일 머신에서 실행되는 여러 인스턴스에 애플리케이션 부하를 분산하는 가장 간단한 패턴은 코어 라이브러리의 일부인 cluster 모듈을 사용하는 것이다.  
클러스터 모듈은 Node.js 애플리케이션을 확장하기 위한 가장 기본적인 메커니즘이다.
